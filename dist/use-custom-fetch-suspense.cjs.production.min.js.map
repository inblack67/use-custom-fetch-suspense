{"version":3,"file":"use-custom-fetch-suspense.cjs.production.min.js","sources":["../src/index.ts"],"sourcesContent":["import produce from 'immer';\nimport lru from 'lru-cache';\nimport md5 from 'md5';\n\nconst cache = new lru(50);\n\nexport default (url: string, options: object={}) => {\n    const key = `${url}.${md5(JSON.stringify(options))}`;\n\n    const value: any = cache.get(key) || { status: 'new', data: null }\n\n    if(value.status === 'resolved'){\n        return value.data;\n    }\n\n    const promise = fetch(url, options).then(res => res.json());\n\n    promise.then(data => {\n        cache.set(key, produce(value, (draft: any) => {\n            draft.status = 'resolved';\n            draft.data = data;\n        }));\n    })\n\n    throw promise; // will be caught by suspense\n}"],"names":["cache","lru","url","options","key","md5","JSON","stringify","value","get","status","data","promise","fetch","then","res","json","set","produce","draft"],"mappings":"kNAIMA,EAAQ,IAAIC,EAAI,6BAENC,EAAaC,YAAAA,IAAAA,EAAgB,QACnCC,EAASF,MAAOG,EAAIC,KAAKC,UAAUJ,IAEnCK,EAAaR,EAAMS,IAAIL,IAAQ,CAAEM,OAAQ,MAAOC,KAAM,SAExC,aAAjBH,EAAME,cACEF,EAAMG,SAGXC,EAAUC,MAAMX,EAAKC,GAASW,MAAK,SAAAC,UAAOA,EAAIC,gBAEpDJ,EAAQE,MAAK,SAAAH,GACTX,EAAMiB,IAAIb,EAAKc,EAAQV,GAAO,SAACW,GAC3BA,EAAMT,OAAS,WACfS,EAAMR,KAAOA,SAIfC"}